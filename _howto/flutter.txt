https://flutterawesome.com/tag/ui/


#! /bin/zsh
cd /Users/jocker/Library/Android/sdk/platform-tools


https://developer.android.com/training/monitoring-device-state/doze-standby

# remove battery
./adb shell dumpsys battery unplug
# before both active
./adb shell dumpsys deviceidle enable
# IDLE - cеть отваливается
# Light: ACTIVE -> IDLE -> IDLE_MAINTENANCE -> OVERRIDE
./adb shell dumpsys deviceidle step light
# IDLE_PENDING
# Deep: ACTIVE -> IDLE_PENDING -> SENSING -> LOCATING -> IDLE -> IDLE_MAINTENANCE
./adb shell dumpsys deviceidle step deep

# now both inactive
./adb shell dumpsys deviceidle step
# Stepped to deep: IDLE_PENDING
./adb shell dumpsys deviceidle step
# Stepped to deep: SENSING
./adb shell dumpsys deviceidle step
# Stepped to deep: IDLE - тут вся сеть отваливается
./adb shell dumpsys deviceidle step
# Stepped to deep: IDLE_MAINTENANCE - тут все просыпается ненадолго (сек 20 примерно)
./adb shell dumpsys deviceidle disable # BACK TO ACTIVE
# Restore battery
./adb shell dumpsys battery reset



./adb shell dumpsys deviceidle force-idle  |  ./adb shell dumpsys deviceidle unforce
./adb shell input keyevent KEYCODE_WAKEUP

# Buttery powered state
./adb shell dumpsys battery | grep powered

# Unplug battery - отключить нах зарядку
./adb shell dumpsys battery unplug

# Reset battery - сбросить настройки зарядки
./adb shell dumpsys battery reset

# Dump Doze mode info
./adb shell dumpsys deviceidle

# Enable Doze mode (may be required on Android Emulator)
./adb shell dumpsys deviceidle enable

# Get status of Light Doze mode
./adb shell dumpsys deviceidle get light

# Get status of Deep Doze mode
./adb shell dumpsys deviceidle get deep

# Enter Light Doze mode (should be called several times to pass all phases)
./adb shell dumpsys deviceidle step light

# Enter Deep Doze mode (should be called several times to pass all phases)
./adb shell dumpsys deviceidle step deep


I found that adb shell dumpsys deviceidle step deep does not cause any real deep sleep side effects.
Only if I enter:
./adb shell dumpsys deviceidle force-idle
my app behaves as in real deep sleep - network connections get disrupted and app thinks its offline.

Also, theres a typo in the comment - the last line should be Deep Doze


LIGHT-DOZE

    Display Off
    Battery not on charging mode

DEEP-DOZE

    Display Off
    Battery not on charging mode
    Device stationary for ~30 minutes

Each of the doze modes will have multiple states.

Light: ACTIVE -> IDLE -> IDLE_MAINTENANCE -> OVERRIDE
Deep: ACTIVE -> IDLE_PENDING -> SENSING -> LOCATING -> IDLE -> IDLE_MAINTENANCE


# отключить нах зарядку
./adb shell dumpsys battery unplug
# сбросить настройки зарядки
./adb shell dumpsys battery reset
# перейти в режим дремоты
./adb shell dumpsys deviceidle step [light|deep]
# получить текущее состояние
./adb shell dumpsys deviceidle get [light|deep|force|screen|charging|network]






adb shell dumpsys battery unplug
adb shell dumpsys deviceidle step light
adb shell dumpsys deviceidle step deep
adb shell dumpsys battery reset















