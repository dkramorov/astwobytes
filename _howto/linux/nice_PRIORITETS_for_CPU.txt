Использование nice для назначения приоритетов

Теперь, когда наша система какое-то время нагружена, давайте посмотрим, как можно установить приоритет для процесса. Давайте подведем краткие итоги уже пройденного материала.

    В операционных системах Linux и UNIX® используется система приоритетов, всего 40 уровней, начиная с -20 (наивысший приоритет) и заканчивая 19 (низший приоритет).
    Процессы, запущенные обычными пользователями, обычно имеют приоритет 0.
    Команда ps может показать приоритет процесса (например, значение nice или NI) с помощью опции -l.
    Команда nice показывает приоритет по умолчанию.

Команду nice можно также использовать для запуска процесса с другим приоритетом. Опция -n (или --adjustment) с положительным значением повышает приоритет, а эта же опция с отрицательным значением – понижает его. Помните, что процесс с наименьшим приоритетом имеет максимальное значение параметра niceness, поэтому увеличение этого значения означает, что процесс становится более дружелюбным по отношению к другим процессам. Заметьте, что, как правило, понижать значение приоритетов процессов может только суперпользователь (root). Другими словами, обычные пользователи могут делать процессы лишь более дружелюбными.

Чтобы продемонстрировать использование команды nice для установки приоритетов, давайте запустим два экземпляра сценария count1.sh в различных подоболочках, но одному из них назначим максимальное значение параметра niceness 19. Через секунду запустим команду ps -l, чтобы посмотреть статус процесса, включая значение niceness. Наконец, добавим произвольную паузу в интервале 30 секунд, чтобы убедиться, что последовательность команд завершится только после завершения работы подоболочек. Таким образом, мы не увидим новое приглашение, пока ожидаем вывода. Результаты представлены в листинге 8.

Листинг 8. Использование nice для установки приоритетов для двух процессов

                   
ian@attic4:~$ (sh count1.sh 2000000 A&);(nice -n 19 sh count1.sh 2000000 B&);\
> sleep 1;ps -l;sleep 10 
