Создаем раздел 1Гб
dd bs=1024 count=102400 if=/dev/zero of=FS
Создаем loop-устройство
losetup /dev/loop1 FS
Делаем файловую систему ext3
mkfs.ext3 /dev/loop1
Монтруем
mkdir tmp && mount /dev/loop1 mnt
Создаем 32к папок
cd mnt
for i in {1..32000} ; do mkdir $i; done
Получаем:
невозможно создать каталог «31998»: Слишком много ссылок
невозможно создать каталог «31999»: Слишком много ссылок
невозможно создать каталог «32000»: Слишком много ссылок

Отключаем и монтируем как ext4
cd .. && umount mnt
mount -t ext4 /dev/loop1 mnt
Создаем опять много папок
cd mnt
for i in {32000..33000} ; do mkdir $i; done
Смотрим результат:
ls |wc -l
33000 
